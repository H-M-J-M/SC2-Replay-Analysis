# Train Model Usage

Trains a machine learning model on a given set of engineered features, evaluates its performance, and saves the resulting model and visualizations.

## Synopsis

`py Train-Model.py <features_csv_path> <model_script_name> [options]`

## Description

This script is the final step in the analysis pipeline, responsible for training and evaluating a model. It takes a feature set generated by `Feature-Engineer.py` and uses a specified model script from the `ModelScripts/` directory to define, train, and evaluate a LightGBM model.

The script's workflow is as follows:
1.  Loads the specified feature CSV file.
2.  Dynamically loads the specified model script (e.g., `predict_winner`).
3.  Splits the data into training and testing sets to prepare for model training and evaluation.
4.  Trains the LightGBM model on the training set.
5.  Evaluates the model on the test set and prints a full report, including accuracy, a classification report, a confusion matrix, and a list of feature importances.
6.  Optionally saves the trained model and performance visualizations to output directories.

## Options

*   `<features_csv_path>` (Required)
    *   The absolute or relative path to the input CSV file containing the engineered features.
*   `<model_script_name>` (Required)
    *   The name of the Python file in the `ModelScripts/` directory to use for defining and preparing the model (e.g., `predict_winner` for `predict_winner.py`).
*   `-v, --visualize`
    *   A flag that, when present, generates and saves visualization plots for the model's performance, including feature importance, a confusion matrix, and a decision tree plot.
*   `-s, --save`
    *   A flag that, when present, saves the trained LightGBM model to a text file in the `OutputModels/` directory.

## Output Files

This script can generate two types of output files.

### Saved Models

*   **Trigger:** The `--save` flag.
*   **Location:** `OutputModels/`
*   **Filename:** `{model_script_name}_{timestamp}.txt` (e.g., `predict_winner_20251107-210000.txt`)
*   **Format:** The model is saved as a text file, which is the standard, cross-language format for LightGBM. This file can be loaded by the LightGBM C++ library for inference.

### Visualizations

*   **Trigger:** The `--visualize` flag.
*   **Location:** `OutputVisualizations/`
*   **Files:**
    *   `feature_importance.png`: A bar chart showing the relative importance of each feature in the model's decisions.
    *   `confusion_matrix.png`: A heatmap showing the detailed breakdown of correct and incorrect predictions.
    *   `decision_tree.png`: A plot of the first decision tree in the LightGBM ensemble.

## Examples

*   **Train a model using a specific feature file:**
    ```sh
    py Train-Model.py OutputFeatures/simple_features/features_20251107-114402.csv predict_winner
    ```

*   **Train a model and generate visualizations:**
    ```sh
    py Train-Model.py OutputFeatures/simple_features/features_20251107-114402.csv predict_winner -v
    ```

*   **Train, visualize, and save the final model:**
    ```sh
    py Train-Model.py OutputFeatures/simple_features/features_20251107-114402.csv predict_winner -v -s
    ```
